(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-041b3913"],{"0e15":function(t,s){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgBAMAAACBVGfHAAAAAXNSR0IArs4c6QAAACFQTFRFAAAAmZmZmZmZmpqamZmZmJiYmpqamZmZmZmZmZmZmZmZj90NQwAAAAp0Uk5TAAV9fqChrq/y85vAgSoAAACVSURBVCjPY2AgAzBPFYAxGT0UgCTnqkSYgNiqCUCSZdUyqBLGrFUBECoRpgAiBaPhMjCGGFwvhIXQCmUiFEDYSAogSpAVgJQsr0JSAFaCooCBQXzVqkIGfAKMVatWLRdAUQA0tBBFQaE4shIQhxHJXqClhSBRuMViYNUIJRjeRw8gjCBkRQ5kB2zRwDwFEVGRBuRENQB0ZkRoxWocxwAAAABJRU5ErkJggg=="},"280a":function(t,s,a){},"5b89":function(t,s,a){"use strict";a("280a")},"5f01":function(t,s,a){"use strict";var i=function(){var t=this,s=t._self._c;return s("transition",{attrs:{name:"fade"}},[t.status?s("div",{staticClass:"mask"},[s("div",{staticClass:"modal"},[s("div",{staticClass:"body"},[s("div",{staticClass:"top"},[s("div",{staticClass:"btn_default",on:{click:t.cancel}},[t._v("取消")])]),s("div",{staticClass:"item"},[s("div",{staticClass:"captcha"},[s("img",{directives:[{name:"show",rawName:"v-show",value:t.captcha.img,expression:"captcha.img"}],attrs:{src:t.captcha.img},on:{click:t.getCaptcha}})])]),s("div",{staticClass:"item"},[s("div",{staticClass:"input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.captcha,expression:"form.captcha"}],staticClass:"input-text",attrs:{type:"text",placeholder:"请输入图中字符"},domProps:{value:t.form.captcha},on:{input:function(s){s.target.composing||t.$set(t.form,"captcha",s.target.value)}}})])])]),s("div",{staticClass:"bottom"},[s("div",{staticClass:"btn_primary",class:{active:t.form.captcha},on:{click:t.change}},[t._v(" 确认 ")])])])]):t._e()])},e=[],o={props:["status","reStatus"],data(){return{captcha:{key:null,img:null},form:{captcha:""}}},mounted(){this.getCaptcha()},watch:{reStatus(){this.form.captcha=null,this.getCaptcha()}},methods:{getCaptcha(){this.$api.Other.Captcha().then(t=>{this.captcha=t.data})},cancel(){this.$emit("cancel",!0)},change(){""!==this.form.captcha.trim()&&this.$emit("change",this.form.captcha,this.captcha)}}},c=o,n=(a("f0ca"),a("2877")),l=Object(n["a"])(c,i,e,!1,null,"22cab0f2",null);s["a"]=l.exports},"617f":function(t,s,a){},"7fed":function(t,s,a){"use strict";a.r(s);var i=function(){var t=this,s=t._self._c;return s("div",{staticClass:"container"},[s("captcha-dialog",{attrs:{status:t.openmask,reStatus:t.reCaptcha},on:{change:t.sendSms,cancel:t.qx}}),s("div",{staticClass:"navheader borderbox",staticStyle:{"border-bottom":"none"}}),t.confirmDialog?[s("confirm-login",{attrs:{text:"绑定",scene:"mobile_bind",status:t.confirmDialog,mobile:t.form.mobile},on:{change:t.submit,cancel:t.cancel}})]:[s("div",{staticClass:"group-form-box"},[s("div",{staticClass:"group-title"},[t._v("绑定手机号")]),s("div",{staticClass:"group-item"},[s("div",{staticClass:"name"},[t._v("手机号")]),s("div",{staticClass:"value"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.mobile,expression:"form.mobile"}],staticClass:"input-text",attrs:{type:"number",placeholder:"请输入您的手机号"},domProps:{value:t.form.mobile},on:{input:function(s){s.target.composing||t.$set(t.form,"mobile",s.target.value)}}}),s("img",{directives:[{name:"show",rawName:"v-show",value:t.form.mobile,expression:"form.mobile"}],staticStyle:{width:"16px",height:"16px"},attrs:{src:a("0e15")},on:{click:function(s){return t.clearMobile()}}})])])]),s("div",{staticClass:"box pl-60 pr-60"},[s("div",{staticClass:"btn-confirm",class:{active:t.form.mobile},on:{click:t.openDialog}},[t._v(" 获取短信验证码 ")])])],t.visible?s("show-model",{attrs:{title:t.modelTitle,text:t.modelText,confirmText:t.confirmText},on:{change:t.confirmModel,cancel:t.cancelModel}}):t._e()],2)},e=[],o=(a("14d9"),a("2f62")),c=a("8add"),n=a("5f01"),l=a("357c"),m={components:{ConfirmLogin:c["a"],CaptchaDialog:n["a"],ShowModel:l["a"]},data(){return{loading:!1,captcha:{img:null,key:null},form:{mobile:"",sms:"",captcha:""},sms:{max:120,current:0,loading:!1},confirmDialog:!1,openmask:!1,reCaptcha:!1,visible:!1,modelTitle:null,modelText:null,confirmText:null}},computed:{...Object(o["c"])(["config"])},mounted(){},methods:{...Object(o["b"])(["submitLogin","logout"]),cancelModel(){this.logout(),this.visible=!1,this.$router.replace({name:"Me"})},confirmModel(){this.visible=!1,"实名认证"===this.modelTitle&&this.goFaceVerify()},goFaceVerify(){let t=this.$utils.getHost()+"/auth/faceSuccess";this.$api.Member.TecentFaceVerify({s_url:t}).then(t=>{this.$utils.saveBizToken(t.data.biz_token),this.$utils.saveRuleId(t.data.rule_id),window.location.href=t.data.url}).catch(t=>{this.$message.error(t.message||"无法发起实名认证")})},clearMobile(){this.form.mobile=null},openDialog(){this.sms.loading||this.form.mobile&&(this.$utils.isChinaMobilePhone(this.form.mobile)?(this.form.captcha=null,this.openmask=!0):this.$message.error("请输入正确的手机号"))},qx(){this.openmask=!1},sendSms(t,s){this.loading||(this.loading=!0,this.form.captcha=t,this.captcha=s,this.$api.Other.SendSms({mobile:this.form.mobile,image_key:this.captcha.key,image_captcha:this.form.captcha,scene:"mobile_bind"}).then(t=>{this.loading=!1,this.openmask=!1,this.confirmDialog=!0}).catch(t=>{this.loading=!1,this.reCaptcha=!this.reCaptcha,this.$message.error(t.message)}))},cancel(){this.confirmDialog=!1},submit(t){this.loading||(this.loading=!0,this.form.sms=t,this.$api.Member.CodeBindMobile({mobile:this.form.mobile,mobile_code:this.form.sms,code:this.$utils.getLoginCode()}).then(t=>{this.loading=!1,this.$message.success("成功"),this.$utils.clearLoginCode(),this.$utils.saveToken(t.data.token),this.$api.User.Detail().then(t=>{this.submitLogin(t.data),!1===t.data.is_face_verify&&!0===this.config.member.enabled_face_verify?(this.modelTitle="实名认证",this.modelText="登录前请完成实名认证",this.confirmText="立即认证",this.visible=!0):setTimeout(()=>{this.$router.push({name:"Index"})},500)})}).catch(t=>{this.loading=!1,this.$message.error(t.message)}))}}},r=m,h=(a("5b89"),a("2877")),d=Object(h["a"])(r,i,e,!1,null,"1089147e",null);s["default"]=d.exports},"8add":function(t,s,a){"use strict";var i=function(){var t=this,s=t._self._c;return t.status?s("div",{staticClass:"box"},[s("captcha-dialog",{attrs:{status:t.openmask,reStatus:t.reCaptcha},on:{change:t.sendSms,cancel:t.qx}}),s("div",{staticClass:"sms-login-form"},[s("div",{staticClass:"sms-login-title"},[t._v("输入短信验证码")]),s("div",{staticClass:"item"},[s("div",{staticClass:"text"},[t._v(" 验证码已发送至 "),s("span",{staticClass:"value"},[t._v(t._s(t.mobile))])]),s("div",{staticClass:"buttons"},[s("span",{staticClass:"send-sms-button",on:{click:function(s){return t.openDialog()}}},[t.sms.loading?[t._v(" "+t._s(t.sms.current)+"s ")]:[t._v("重新发送")]],2)])]),s("div",{staticClass:"item"},[s("div",{staticClass:"name"},[t._v("验证码")]),s("div",{staticClass:"input"},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.form.sms,expression:"form.sms"}],staticClass:"input-text",attrs:{type:"number",placeholder:"请输入短信验证码"},domProps:{value:t.form.sms},on:{input:function(s){s.target.composing||t.$set(t.form,"sms",s.target.value)}}}),s("img",{directives:[{name:"show",rawName:"v-show",value:t.form.sms,expression:"form.sms"}],staticStyle:{width:"16px",height:"16px"},attrs:{src:a("0e15")},on:{click:function(s){return t.clearSms()}}})])])]),s("div",{staticClass:"login-button-box"},[s("div",{staticClass:"btn-confirm",class:{active:t.form.sms},on:{click:t.confirm}},[t._v(" "+t._s(t.text)+" ")])])],1):t._e()},e=[],o=a("5f01"),c={components:{CaptchaDialog:o["a"]},props:["mobile","status","text","scene"],data(){return{interval:null,openmask:!1,captcha:{key:null,img:null},form:{sms:"",captcha:""},sms:{loading:!1,max:120,current:0},reCaptcha:!1}},beforeDestroy(){clearInterval(this.interval)},mounted(){this.sms.loading=!0,this.sms.current=this.sms.max,this.interval=setInterval(()=>{this.sms.current<=1?(this.sms.loading=!1,clearInterval(this.interval)):this.sms.current--},1e3)},methods:{goBack(){this.$emit("cancel",!0)},openDialog(){this.sms.loading||(this.form.captcha=null,this.openmask=!0)},qx(){this.openmask=!1},sendSms(t,s){this.form.captcha=t,this.captcha=s,this.$api.Other.SendSms({mobile:this.mobile,image_key:this.captcha.key,image_captcha:this.form.captcha,scene:this.scene}).then(()=>{this.sms.loading=!0,this.sms.current=this.sms.max,this.interval=setInterval(()=>{this.sms.current<=1?(this.sms.loading=!1,clearInterval(this.interval)):this.sms.current--},1e3),this.openmask=!1}).catch(t=>{this.reCaptcha=!this.reCaptcha,this.$message.error(t.message)})},getCaptcha(){this.$api.Other.Captcha().then(t=>{this.captcha=t.data})},clearSms(){this.form.sms=null},confirm(){""!==this.form.sms.trim()?this.$emit("change",this.form.sms):this.$message.error("请输入短信验证码")}}},n=c,l=(a("fe73"),a("2877")),m=Object(l["a"])(n,i,e,!1,null,"2c4375c0",null);s["a"]=m.exports},d8e2:function(t,s,a){},f0ca:function(t,s,a){"use strict";a("d8e2")},fe73:function(t,s,a){"use strict";a("617f")}}]);